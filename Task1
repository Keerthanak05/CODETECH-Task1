import gradio as gr
from diffusers import StableDiffusionPipeline
import torch

# Load Stable Diffusion model
pipe = StableDiffusionPipeline.from_pretrained("runwayml/stable-diffusion-v1-5", torch_dtype=torch.float16)
pipe.to("cuda" if torch.cuda.is_available() else "cpu")  # Use GPU if available

# Define the function to generate images
def generate_and_display(prompt):
    if not prompt.strip():
        return "Please enter a valid text prompt."

    try:
        # Generate the image
        image = pipe(prompt).images[0]
        return image
    except Exception as e:
        return f"Error generating image: {str(e)}"

# Create the Gradio interface
interface = gr.Interface(
    fn=generate_and_display,
    inputs="text",
    outputs="image",
    title="Text-to-Image Generator",
    description="Enter a text prompt, and the model will generate an image based on your description.",
    examples=[
        "A futuristic city with flying cars and neon lights.",
        "A magical forest with glowing mushrooms and fairies.",
        "A tiger walking through a dense jungle at sunset.",
        "A steampunk airship floating above the clouds."
    ]
)

# Launch the app
interface.launch()

